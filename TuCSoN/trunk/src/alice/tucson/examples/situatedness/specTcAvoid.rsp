reaction(
	time(200),
	endo,
	(
		out(input(ag_feelforce)),
		out(input(ag_wander))
	)
).

reaction( 
	in(can_suppress(Tci,Tcs,Time)), 
	(exo, response),
	( 
		in(input(Tci)), out(input(Tcs)),
		current_time(CurrentT), NewTime is CurrentT + Time,
		out_s( 
			time(NewTime), 
			endo,
			( 
				in(input(Tcs)), out(input(Tci)),
				out(can_suppress(Tci,Tcs,Time))
			)
		)
	)
).

reaction( 
	out(data(X)), 
	(exo, response),
	( 
		event_source(Tc), rd(input(Tc)),
		in(data(X)), out(X) 
	)
).

reaction( 
	out(data(X)), 
	(exo, response),
	( 
		event_source(Tc), no(input(Tc)),
		in(data(X))
	)
).

reaction( 
	in(can_inhibit(Tco,Tcs,Time)), 
	(exo, response),
	( 
		in(output(Tco)),
		current_time(CurrentT), NewTime is CurrentT + Time,
		out_s( 
				time(NewTime), 
				endo,
				( 
					out(output(Tco)),
					out(can_inhibit(Tco,Tcs,Time))
				)
		)
	)
).

reaction( 
	inp(data(X)), 
	(from_agent, request),
	( 
		in(X),
		event_source(Ag), rd(output(Ag)),
		out(X) 
	)
).

reaction( 
	out(random_direction(A,S)), 
	endo,
	( 
		in(direction(A1,S1)), 
		% select_direction(A,S,A1,S1,Ao,So),
		% out(selected_direction(Ao,So)),
		out(selected_direction(A1,S1)),
		tc_motor@localhost:20504 ? in(can_suppress(tc_runaway,tc_avoid,5000)) 
	)
).

reaction( 
	in(can_suppress(tc_runaway,tc_avoid,5000)), 
	(response, exo),
	( 
		in(selected_direction(Ao,So)),
		tc_motor@localhost:20504 ? out(command(Ao,So)) 
	)
).